<script>
const SHEET_ID = "1vTkhpM4wvp0q67eqKpGtdoPgmltqWWgrAvcELyh4an5jDw";
const SHEET_NAME = "Sheet1"; // change if your tab name is different

const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`;

fetch(url)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substr(47).slice(0, -2));
    const rows = json.table.rows;
    const feed = document.getElementById("feed");

    rows.forEach(r => {
      const [
        source,
        headline,
        link,
        published,
        impact_severity,
        manual_impact,
        why_it_matters,
        add_severity,
        horizon,
        status
      ] = r.c.map(c => c ? c.v : "");

      if (!status || !status.toLowerCase().includes("publish")) return;

      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <div class="source">${source}</div>

        <a class="headline" href="${link}" target="_blank">
          ${headline}
        </a>

        <div class="impact">
          <strong>Manual impact:</strong> ${manual_impact}
        </div>

        <div class="why">
          <strong>Why it matters:</strong> ${why_it_matters}
        </div>

        <div class="meta">
          <span class="badge">${add_severity}</span>
          <span class="badge">${horizon}</span>
          <span class="badge">${published}</span>
        </div>
      `;

      feed.appendChild(card);
    });
  })
  .catch(err => console.error("Sheet error:", err));
</script>

